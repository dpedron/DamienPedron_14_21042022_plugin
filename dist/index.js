"use strict";var e=require("react"),t=require("prop-types");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=o(e),a=o(t);function r({options:t,selectId:o,theme:a}){const[r,i]=e.useState(!1),[l,d]=e.useState([]),[s,c]=e.useState(0),p=document.getElementById(o),u=document.getElementById(o).value||"",m=document.getElementById(o).size,f=document.getElementById(`${o}-list`),h=document.getElementById(`${o}-button`),g=document.getElementById(`${o}-button-title`),b=document.querySelector(".option"),v=t.find((e=>""===e.value)),y=t.findIndex((e=>""===e.value)),x=m>0;!r&&x&&i(!0);const E=document.getElementById(o).disabled;function w(){if(void 0!==t[s]&&t[s]&&(!t[s].disabled||v)&&"optgroup"!==t[s].type&&(g&&(g.innerText=t[s].name,p.value=g.innerText,""!==p.value&&p.dispatchEvent(new Event("change",{bubbles:!0}))),f&&x)){const e=[...f.children].find((e=>e.classList.contains("selected")));e&&(p.value=e.innerText,""!==p.value&&p.dispatchEvent(new Event("change",{bubbles:!0})))}}function k(e){i(!1),c([...l].findIndex((t=>e.target.innerText===t.innerText))),e.target.classList.add("selected"),[...e.target.parentElement.children].forEach((t=>!(t.className.includes("selected")&&t.id===e.target.id)&&t.classList.remove("selected")))}function I(e,o){return"optgroup"===t[e].type||t[e].disabled?(c(o),o):(c(e),e)}e.useEffect((()=>{!function(){if(null===g)return;let e=s;if(v)e=y;else{if(("optgroup"===t[e].type||t[e].disabled)&&void 0!==t[e+1])do{e++}while("optgroup"===t[e].type||t[e].disabled);c(e)}}(),w(),function(){const e=document.getElementById(`${o}-list`),t=document.getElementById(`${o}-button`);d(r?e.children:t.parentElement.previousElementSibling.children)}(),function(){if(x||""===p.value)return;f&&-1!==s&&void 0!==f.children[s]&&(f.children[s].focus(),d(f.children))}(),x&&E&&[...l].forEach((e=>e.classList.add("disabled")))})),document.onclick=e=>{document.querySelector(".handle-click")===e.target&&i(!1)};const N=e=>"s"===e?"12px":"m"===e?"16px":"l"===e?"24px":"16px";function $(e){let o=s,n=o;if(e.target.classList.contains("option")&&"Tab"===e.code)k(e);else if(!h&&!x||"Tab"!==e.code){if(e.preventDefault(),o>=1&&("ArrowUp"===e.code||"ArrowLeft"===e.code)&&!e.altKey){do{o>=1&&o--}while(o>=1&&("optgroup"===t[o].type||t[o].disabled));I(o,n),f&&x&&(f.children[o].focus(),p.value=document.activeElement.innerText)}if(s<t.length-1&&("ArrowDown"===e.code||"ArrowRight"===e.code)&&!e.altKey){do{o++}while(("optgroup"===t[o].type||t[o].disabled)&&o<t.length-2);I(o,n),f&&x&&(0===s&&document.activeElement===f&&(o=0,c(o)),f.children[o].focus(),p.value=document.activeElement.innerText)}if("Home"===e.code||"PageUp"===e.code){let e=0;for(;("optgroup"===t[e].type||t[e].disabled)&&e<t.length-2;)e++;I(e,n),f&&x&&(f.children[I(e,n)].focus(),p.value=document.activeElement.innerText)}if("End"===e.code||"PageDown"===e.code){let e=t.length-1;for(;("optgroup"===t[e].type||t[e].disabled)&&e>1;)e--;I(e,n),f&&x&&(f.children[I(e,n)].focus(),p.value=document.activeElement.innerText)}if(r&&(!x&&("Escape"===e.code||e.altKey&&"ArrowUp"===e.code)&&(h.focus(),i(!1)),l.length>0&&("Enter"!==e.code&&"Space"!==e.code||(!x&&h.focus(),e.target.classList.contains("option")&&k(e)))),!r){if("Enter"===e.code)return;(e.altKey&&"ArrowDown"===e.code||"Space"===e.code)&&i(!0)}w()}}return n.default.createElement("div",{className:"select-wrapper"},!x&&n.default.createElement("div",{className:"select-button "+(E?"disabled":""),"data-theme":a,id:`${o}-button`,onKeyDown:e=>{$(e)},onClick:()=>i(!r),tabIndex:E?"-1":"0"},n.default.createElement("span",{"data-theme":a,id:`${o}-button-title`},u),n.default.createElement("svg",{className:"chevron "+(E?"disabled":""),"data-theme":a,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"},n.default.createElement("path",{d:"M192 384c-8.188 0-16.38-3.125-22.62-9.375l-160-160c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L192 306.8l137.4-137.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-160 160C208.4 380.9 200.2 384 192 384z"}))),r&&n.default.createElement(n.default.Fragment,null,!x&&n.default.createElement("div",{className:"handle-click"}),n.default.createElement("ul",{id:`${o}-list`,className:"list "+(x?"":"no-size"),style:{height:b&&x&&m*b.clientHeight+"px"},tabIndex:E||!x?"-1":"0","data-theme":a,onKeyDown:e=>{$(e)}},t.map(((e,t)=>"optgroup"===e.type?n.default.createElement(n.default.Fragment,{key:`${e.name}${t}`},n.default.createElement("li",{"data-theme":a,key:`${e.name}`,className:"optgroup"},e.name),void 0!==e.options&&"option"===e.options.type&&n.default.createElement("li",{style:{display:""===e.props.value?"none":"list-item"},key:e.options.props.children,id:`${o}-${e.options.props.children}`,className:"option "+(e.props.disabled?"disabled":""),"data-theme":a,onClick:e=>k(e),tabIndex:e.props.disabled?"-1":"0",onKeyDown:e=>{$(e)}},e.props.imgsrc&&n.default.createElement("img",{alt:"",className:"option-pic",src:e.props.imgsrc,width:N(e.props.imgsize)}),n.default.createElement("span",{className:"option-text","data-theme":a},e.options.props.children)),e.options&&e.options.length>1&&e.options.map((e=>n.default.createElement("li",{style:{display:""===e.props.value?"none":"list-item"},key:e.props.children,id:`${o}-${e.props.children}`,"data-theme":a,className:"option "+(e.props.disabled?"disabled":""),onClick:e=>k(e),tabIndex:e.props.disabled?"-1":"0",onKeyDown:e=>{$(e)}},e.props.imgsrc&&n.default.createElement("img",{alt:"",className:"option-pic",src:e.props.imgsrc,width:N(e.props.imgsize)}),n.default.createElement("span",{className:"option-text","data-theme":a},e.props.children))))):n.default.createElement("li",{style:{display:""===e.value?"none":"list-item"},key:e.name,id:`${o}-${e.name}`,"data-theme":a,className:"option "+(e.disabled?"disabled":""),onClick:e=>k(e),tabIndex:e.disabled||x?"-1":"0",onKeyDown:e=>{$(e)}},e.imgsrc&&n.default.createElement("img",{alt:"",className:"option-pic",src:e.imgsrc,width:N(e.imgsize)}),n.default.createElement("span",{className:"option-text","data-theme":a},e.name)))))))}function i({children:t,theme:o="default"}){const[a,i]=e.useState(!1),l=t.props.id;e.useEffect((()=>{document.getElementById(l).style.display="none",i(!0)}));let d=[],s=e=>d.push({name:e.props.children,type:e.type,value:e.props.value,imgsrc:e.props.imgsrc,imgsize:e.props.imgsize||"16px",disabled:e.props.disabled});return void 0===t.props.children?d.push({name:"no-option",type:"option",disabled:!0}):void 0===t.props.children.length?s(t.props.children):t.props.children.forEach((e=>{"optgroup"===e.type?(d.push({name:e.props.label,type:e.type}),e.props.children&&e.props.children.forEach((e=>{s(e)}))):void 0===e.length?s(e):e.forEach((e=>{s(e)}))})),n.default.createElement(n.default.Fragment,null,t,a&&n.default.createElement(r,{options:d,selectId:l,theme:o}))}!function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===o&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}(":root{--background-color:#fff;--border-color:#ced4da;--text-color:#000;--active-text-color:#fff;--active-background-color:#007fff;--disabled-color:grey;--chevron-filter-disabled:brightness(0) saturate(100%) invert(96%) sepia(0%) saturate(173%) hue-rotate(189deg) brightness(94%) contrast(80%)}.select-wrapper{padding:0;position:relative}.optgroup{font-weight:700;padding:5px}.optgroup,.option{background-color:var(--background-color);color:var(--text-color)}.option{align-items:center;cursor:pointer;display:flex;padding:5px 10px}.option:focus,.option:hover,.selected{background:var(--active-background-color);color:var(--active-text-color)}.select-button{align-items:center;background:var(--background-color);border:1px solid var(--border-color);border-radius:.25rem;color:var(--text-color);cursor:pointer;display:flex;justify-content:space-between;padding:6px 16px}.chevron{filter:var(--chevron-filter);height:15px}.list{border:1px solid var(--border-color);list-style-type:none;margin:0;max-height:420px;overflow-y:auto;padding-left:0;position:absolute;width:100%}.no-size{z-index:10}.label{margin:16px 0 0;padding:0}.option-pic,.option-text{pointer-events:none}.option-text{padding:0 16px}.disabled{color:var(--disabled-color);pointer-events:none}.chevron.disabled{filter:var(--chevron-filter-disabled)}.handle-click{height:100vh;left:0;position:fixed;top:0;width:100%;z-index:9}[data-theme=light]{--background-color:#fcfdfe;--border-color:#e9f0f8;--text-color:#afc9e6;--active-text-color:#fcfdfe;--active-background-color:#afc9e6;--disabled-color:#ededed;--chevron-filter:brightness(0) saturate(100%) invert(84%) sepia(11%) saturate(668%) hue-rotate(174deg) brightness(92%) contrast(97%);--chevron-filter-disabled:brightness(0) saturate(100%) invert(97%) sepia(3%) saturate(821%) hue-rotate(213deg) brightness(114%) contrast(86%)}[data-theme=dark]{--background-color:#212a2e;--border-color:grey;--text-color:#d3d3d3;--active-text-color:#fff;--active-background-color:grey;--disabled-color:grey;--chevron-filter:brightness(0) saturate(100%) invert(92%) sepia(2%) saturate(14%) hue-rotate(85deg) brightness(96%) contrast(85%);--chevron-filter-disabled:brightness(0) saturate(100%) invert(57%) sepia(0%)}"),r.propTypes={options:a.default.array,selectId:a.default.string.isRequired,theme:a.default.string},i.propTypes={children:a.default.object,theme:a.default.string},module.exports=i;
